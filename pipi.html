<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JERCAT DEX + Secure Wallet - Complete Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/web3@1.8.0/dist/web3.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .animate-pulse { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        @keyframes slideIn { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .animate-slide-in { animation: slideIn 0.3s ease-out; }
        @keyframes confetti { 0% { transform: translateY(0) rotate(0deg); opacity: 1; } 100% { transform: translateY(100vh) rotate(720deg); opacity: 0; } }
        .confetti { position: fixed; width: 10px; height: 10px; animation: confetti 3s ease-out forwards; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
        .loading-spinner { border: 3px solid rgba(255, 255, 255, 0.1); border-top-color: #f59e0b; border-radius: 50%; width: 20px; height: 20px; animation: spin 0.8s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .tab-active { border-bottom: 2px solid #f59e0b; color: #f59e0b; }
        input[type="number"]::-webkit-inner-spin-button, input[type="number"]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
        input[type="number"] { -moz-appearance: textfield; }
        .chart-container { position: relative; height: 300px; }
        .reward-badge { animation: bounceIn 0.5s ease-out; }
        @keyframes bounceIn { 0% { transform: scale(0); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 text-white">
    
    <!-- Premium Header -->
    <div class="border-b border-slate-700/50 bg-black/40 backdrop-blur-xl sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 py-3">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-8">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 bg-gradient-to-br from-amber-400 to-orange-500 rounded-lg flex items-center justify-center font-black text-xl shadow-lg shadow-amber-500/50">J</div>
                        <span class="text-white font-black text-xl tracking-tight">JERCAT DEX</span>
                    </div>
                    <div class="hidden md:flex items-center gap-6 border-l border-slate-700 pl-6">
                        <button onclick="switchTab('swap')" id="tab-swap" class="tab-active px-3 py-2 font-bold text-sm transition-all">Swap</button>
                        <button onclick="switchTab('wallet')" id="tab-wallet" class="px-3 py-2 font-bold text-sm text-slate-400 hover:text-white transition-all">Wallet</button>
                        <button onclick="switchTab('portfolio')" id="tab-portfolio" class="px-3 py-2 font-bold text-sm text-slate-400 hover:text-white transition-all">Portfolio</button>
                        <button onclick="switchTab('staking')" id="tab-staking" class="px-3 py-2 font-bold text-sm text-slate-400 hover:text-white transition-all">Staking</button>
                        <button onclick="switchTab('rewards')" id="tab-rewards" class="px-3 py-2 font-bold text-sm text-slate-400 hover:text-white transition-all relative">
                            Rewards
                            <span id="rewardsNotif" class="hidden absolute -top-1 -right-1 w-2 h-2 bg-emerald-400 rounded-full animate-pulse"></span>
                        </button>
                    </div>
                </div>
                <div class="flex items-center gap-3">
                    <div class="hidden md:flex items-center gap-2 bg-slate-800 rounded-lg px-3 py-2 border border-slate-700">
                        <span class="text-2xl" id="currentChainLogo">üü°</span>
                        <span class="text-white font-bold text-sm" id="currentChainName">BSC</span>
                    </div>
                    <button onclick="showWalletOptions()" id="connectBtn" class="bg-gradient-to-r from-amber-500 to-orange-500 hover:from-amber-600 hover:to-orange-600 text-black px-6 py-2.5 rounded-lg font-bold text-sm shadow-lg transition-all">Connect Wallet</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notifications -->
    <div id="notifications" class="fixed top-20 right-4 z-50 space-y-2"></div>

    <div class="max-w-7xl mx-auto px-4 py-8">
        <!-- Stats Bar -->
        <div class="grid grid-cols-2 md:grid-cols-6 gap-4 mb-8">
            <div class="bg-gradient-to-br from-slate-800 to-slate-900 border border-slate-700 rounded-xl p-4">
                <div class="text-xs text-slate-400 mb-1 font-medium">JERCAT Price</div>
                <div class="text-xl font-black text-white">$<span id="headerPrice">0.00</span></div>
                <div class="text-xs font-bold mt-1 text-emerald-400" id="headerChange">+0%</div>
            </div>
            <div class="bg-gradient-to-br from-slate-800 to-slate-900 border border-slate-700 rounded-xl p-4">
                <div class="text-xs text-slate-400 mb-1 font-medium">Market Cap</div>
                <div class="text-xl font-black text-white" id="headerMcap">$0</div>
            </div>
            <div class="bg-gradient-to-br from-slate-800 to-slate-900 border border-slate-700 rounded-xl p-4">
                <div class="text-xs text-slate-400 mb-1 font-medium">24h Volume</div>
                <div class="text-xl font-black text-white" id="headerVolume">$0</div>
            </div>
            <div class="bg-gradient-to-br from-slate-800 to-slate-900 border border-slate-700 rounded-xl p-4">
                <div class="text-xs text-slate-400 mb-1 font-medium">Your Balance</div>
                <div class="text-xl font-black text-white"><span id="headerBalance">0</span> üê±</div>
            </div>
            <div class="bg-gradient-to-br from-slate-800 to-slate-900 border border-slate-700 rounded-xl p-4">
                <div class="text-xs text-slate-400 mb-1 font-medium">Gas Price</div>
                <div class="text-xl font-black text-blue-400" id="headerGas">-- Gwei</div>
            </div>
            <div class="bg-gradient-to-br from-emerald-900/30 to-slate-900 border border-emerald-500/30 rounded-xl p-4">
                <div class="text-xs text-emerald-400 mb-1 font-medium">Total Rewards</div>
                <div class="text-xl font-black text-white"><span id="totalRewards">0</span> üê±</div>
            </div>
        </div>

        <!-- Content sections will be added via JavaScript for brevity -->
        <div id="app-content"></div>
    </div>

    <!-- Modals will be added via JavaScript -->
    <div id="modals-container"></div>

    <script>
        // Configuration
        const JERCAT_ADDRESS = '0x197CF8951d93325A9333857Ee5330daF7aC4bcCF';
        const WBNB_ADDRESS = '0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c';
        const PANCAKESWAP_ROUTER = '0x10ED43C718714eb63d5aA57B78B54704E256024E';
        const BSC_RPC = 'https://bsc-dataseed.binance.org/';
        const PLATFORM_FEE_RECEIVER = '0xVOTRE_ADRESSE_ICI';

        let web3, account = '', slippage = 1.0, jercatPrice = 0, bnbPrice = 600;
        let priceChart, portfolioChart, allocationChart;
        let userRewards = { total: 0, history: [], swapCount: 0, totalVolume: 0 };

        const tokens = {
            BNB: { symbol: 'BNB', name: 'Binance Coin', logo: 'üü°', address: WBNB_ADDRESS, decimals: 18 },
            JERCAT: { symbol: 'JERCAT', name: 'JERCAT Token', logo: 'üê±', address: JERCAT_ADDRESS, decimals: 18 }
        };
        let fromToken = tokens.BNB, toToken = tokens.JERCAT;

        const ERC20_ABI = [{"constant":true,"inputs":[{"name":"_owner","type":"address"}],"name":"balanceOf","outputs":[{"name":"balance","type":"uint256"}],"type":"function"},{"constant":false,"inputs":[{"name":"_spender","type":"address"},{"name":"_value","type":"uint256"}],"name":"approve","outputs":[{"name":"","type":"bool"}],"type":"function"}];
        const ROUTER_ABI = [{"inputs":[{"internalType":"uint256","name":"amountIn","type":"uint256"},{"internalType":"address[]","name":"path","type":"address[]"}],"name":"getAmountsOut","outputs":[{"internalType":"uint256[]","name":"amounts","type":"uint256[]"}],"stateMutability":"view","type":"function"}];

        // Initialize app
        async function init() {
            renderApp();
            renderModals();
            updatePrices();
            initCharts();
            autoReconnect();
            setInterval(updatePrices, 30000);
        }

        function renderApp() {
            document.getElementById('app-content').innerHTML = `
                <div id="content-swap" class="content-section">
                    <div class="bg-gradient-to-br from-slate-800 to-slate-900 border border-slate-700 rounded-2xl p-6 max-w-2xl mx-auto">
                        <h2 class="text-2xl font-black text-white mb-6">Swap Tokens</h2>
                        <div class="mb-3">
                            <label class="text-xs text-slate-400 mb-2 block font-semibold uppercase">You Pay</label>
                            <div class="bg-slate-900 rounded-xl p-5 border border-slate-700">
                                <div class="flex justify-between items-center mb-3">
                                    <input type="text" id="fromAmount" oninput="validateAndCalculate(this)" placeholder="0.00" class="flex-1 bg-transparent text-white text-3xl outline-none font-bold placeholder-slate-600" autocomplete="off">
                                    <div class="text-white font-bold text-sm"><span id="fromTokenLogo">üü°</span> <span id="fromTokenSymbol">BNB</span></div>
                                </div>
                                <div class="flex justify-between items-center">
                                    <div class="text-sm text-slate-400" id="fromAmountUSD">$0.00</div>
                                    <button onclick="setMaxAmount()" class="text-sm text-amber-400 hover:text-amber-300 font-semibold">Balance: <span id="fromBalance">0.0</span></button>
                                </div>
                            </div>
                        </div>
                        <div class="flex justify-center -my-2 relative z-10">
                            <button onclick="switchTokens()" class="bg-gradient-to-br from-amber-500 to-orange-500 p-2.5 rounded-xl hover:scale-110 border-4 border-slate-800 transition-all">
                                <svg class="w-5 h-5 text-black" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"></path></svg>
                            </button>
                        </div>
                        <div class="mb-6">
                            <label class="text-xs text-slate-400 mb-2 block font-semibold uppercase">You Receive</label>
                            <div class="bg-slate-900 rounded-xl p-5 border border-slate-700">
                                <div class="flex justify-between items-center mb-3">
                                    <input type="text" id="toAmount" readonly placeholder="0.00" class="flex-1 bg-transparent text-white text-3xl outline-none font-bold">
                                    <div class="text-white font-bold text-sm"><span id="toTokenLogo">üê±</span> <span id="toTokenSymbol">JERCAT</span></div>
                                </div>
                                <div class="flex justify-between items-center">
                                    <div class="text-sm text-slate-400" id="toAmountUSD">$0.00</div>
                                    <div class="text-sm text-slate-400">Balance: <span id="toBalance">0.0</span></div>
                                </div>
                            </div>
                        </div>
                        <button onclick="handleSwap()" id="swapBtn" class="w-full bg-gradient-to-r from-amber-500 to-orange-500 hover:from-amber-600 hover:to-orange-600 text-black py-4 rounded-xl font-black text-lg transition-all shadow-lg">Connect Wallet</button>
                        <div id="tradeDetails" class="hidden mt-5 bg-slate-900 rounded-xl p-4 space-y-3 text-sm border border-slate-700">
                            <div class="flex justify-between"><span class="text-slate-400">Rate</span><span class="text-white font-semibold" id="exchangeRate">-</span></div>
                            <div class="flex justify-between"><span class="text-emerald-400">üéÅ Reward (0.1%)</span><span class="text-emerald-400 font-bold" id="rewardAmount">-</span></div>
                        </div>
                    </div>
                </div>
                <div id="content-wallet" class="content-section hidden"><div class="text-center text-slate-400 py-20">Wallet view - Connect wallet to see details</div></div>
                <div id="content-portfolio" class="content-section hidden"><div class="text-center text-slate-400 py-20">Portfolio view</div></div>
                <div id="content-staking" class="content-section hidden"><div class="text-center text-slate-400 py-20">Staking coming soon</div></div>
                <div id="content-rewards" class="content-section hidden">
                    <div class="max-w-4xl mx-auto">
                        <div class="bg-gradient-to-br from-emerald-900/30 via-slate-800 to-slate-900 border border-emerald-500/30 rounded-2xl p-8 mb-6">
                            <div class="flex items-center justify-between">
                                <div><div class="text-sm text-emerald-400 mb-2 font-semibold">Total Rewards Earned</div>
                                <div class="text-5xl font-black text-white mb-2"><span id="totalRewardsDisplay">0</span> üê±</div></div>
                                <div class="w-16 h-16 bg-emerald-500/20 rounded-xl flex items-center justify-center text-3xl">üéÅ</div>
                            </div>
                        </div>
                        <div class="bg-gradient-to-br from-slate-800 to-slate-900 border border-slate-700 rounded-2xl p-6">
                            <h3 class="text-xl font-bold text-white mb-6">Rewards History</h3>
                            <div id="rewardsHistory" class="space-y-3"><div class="text-center py-12 text-slate-400">Pas encore de r√©compenses</div></div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderModals() {
            document.getElementById('modals-container').innerHTML = `
                <div id="walletModal" class="hidden fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
                    <div class="bg-slate-800 rounded-2xl max-w-md w-full border border-slate-700 animate-slide-in">
                        <div class="flex items-center justify-between p-6 border-b border-slate-700">
                            <h3 class="text-xl font-bold text-white">Connect Wallet</h3>
                            <button onclick="closeWalletModal()" class="p-2 hover:bg-slate-700 rounded-lg transition-all">
                                <svg class="w-5 h-5 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                            </button>
                        </div>
                        <div class="p-6 space-y-3">
                            <button onclick="connectMetaMask()" class="w-full bg-slate-900 hover:bg-slate-700 border border-slate-700 rounded-xl p-4 transition-all flex items-center gap-4">
                                <div class="w-12 h-12 bg-gradient-to-br from-orange-400 to-orange-600 rounded-lg flex items-center justify-center text-2xl">ü¶ä</div>
                                <div class="flex-1 text-left"><div class="text-white font-bold">MetaMask</div><div class="text-slate-400 text-sm">Connect with MetaMask</div></div>
                            </button>
                            <button onclick="connectSecureWallet()" class="w-full bg-gradient-to-br from-emerald-900/30 to-slate-900 hover:from-emerald-900/50 border-2 border-emerald-500/50 rounded-xl p-4 transition-all flex items-center gap-4">
                                <div class="w-12 h-12 bg-gradient-to-br from-emerald-400 to-emerald-600 rounded-lg flex items-center justify-center text-2xl">üîê</div>
                                <div class="flex-1 text-left"><div class="text-white font-bold">JERCAT Secure Wallet <span class="text-xs bg-emerald-500/20 text-emerald-400 px-2 py-0.5 rounded-full">New</span></div><div class="text-slate-400 text-sm">Trading s√©curis√©</div></div>
                            </button>
                        </div>
                    </div>
                </div>
                <div id="modal" class="hidden fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
                    <div class="bg-slate-800 rounded-2xl max-w-md w-full border border-slate-700 animate-slide-in">
                        <div class="flex items-center justify-between p-6 border-b border-slate-700">
                            <h3 class="text-xl font-bold text-white" id="modalTitle">Modal</h3>
                            <button onclick="closeModal()" class="p-2 hover:bg-slate-700 rounded-lg transition-all">
                                <svg class="w-5 h-5 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                            </button>
                        </div>
                        <div id="modalContent" class="p-6"></div>
                    </div>
                </div>
            `;
        }

        // Wallet functions
        function showWalletOptions() { document.getElementById('walletModal').classList.remove('hidden'); }
        function closeWalletModal() { document.getElementById('walletModal').classList.add('hidden'); }
        function closeModal() { document.getElementById('modal').classList.add('hidden'); }

        async function connectMetaMask() {
            if (typeof window.ethereum === 'undefined') {
                showNotification('Please install MetaMask!', 'error');
                return;
            }
            try {
                const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                const chainId = await window.ethereum.request({ method: 'eth_chainId' });
                if (chainId !== '0x38') {
                    await window.ethereum.request({ method: 'wallet_switchEthereumChain', params: [{ chainId: '0x38' }] });
                }
                account = accounts[0];
                web3 = new Web3(window.ethereum);
                localStorage.setItem('walletType', 'metamask');
                updateUI();
                await loadBalances();
                closeWalletModal();
                showNotification('‚úÖ Connected!', 'success');
            } catch (error) {
                console.error(error);
                showNotification('Connection failed', 'error');
            }
        }

        function connectSecureWallet() {
            closeWalletModal();
            if (localStorage.getItem('encryptedWallet')) {
                openSecureWalletLogin();
            } else {
                showNotification('Redirecting to Secure Wallet...', 'info');
                setTimeout(() => window.open('https://wallet-one-ochre.vercel.app/', '_blank'), 1000);
            }
        }

        function openSecureWalletLogin() {
            document.getElementById('modal').classList.remove('hidden');
            document.getElementById('modalTitle').textContent = 'üîê Secure Wallet Login';
            document.getElementById('modalContent').innerHTML = `
                <div class="space-y-4">
                    <div><label class="block text-sm text-slate-400 mb-2 font-semibold">Password</label>
                    <input type="password" id="secureWalletPassword" placeholder="Enter password" class="w-full bg-slate-900 border border-slate-700 text-white px-4 py-3 rounded-lg" onkeypress="if(event.key==='Enter') unlockSecureWallet()"></div>
                    <button onclick="unlockSecureWallet()" class="w-full bg-gradient-to-r from-emerald-500 to-emerald-600 text-white py-3 rounded-lg font-bold">Unlock</button>
                    <button onclick="closeModal()" class="w-full bg-slate-700 text-white py-3 rounded-lg font-bold">Cancel</button>
                </div>
            `;
        }

        async function unlockSecureWallet() {
            const password = document.getElementById('secureWalletPassword').value;
            if (!password) { showNotification('Enter password', 'error'); return; }
            try {
                const encrypted = localStorage.getItem('encryptedWallet');
                const decrypted = CryptoJS.AES.decrypt(encrypted, password).toString(CryptoJS.enc.Utf8);
                if (!decrypted) { showNotification('‚ùå Incorrect password', 'error'); return; }
                const walletData = JSON.parse(decrypted);
                web3 = new Web3(BSC_RPC);
                account = walletData.address;
                localStorage.setItem('walletType', 'secure');
                updateUI();
                await loadBalances();
                closeModal();
                showNotification('üîê Secure Wallet connected!', 'success');
            } catch (error) {
                showNotification('‚ùå Error', 'error');
            }
        }

        function updateUI() {
            const connectBtn = document.getElementById('connectBtn');
            if (account) {
                const walletType = localStorage.getItem('walletType');
                const icon = walletType === 'secure' ? 'üîê' : 'ü¶ä';
                connectBtn.innerHTML = `${icon} ${account.slice(0,6)}...${account.slice(-4)}`;
                connectBtn.classList.add('bg-emerald-500');
                connectBtn.onclick = () => showAccountMenu();
                document.getElementById('swapBtn').textContent = 'Enter Amount';
            }
        }

        function showAccountMenu() {
            document.getElementById('modal').classList.remove('hidden');
            document.getElementById('modalTitle').textContent = 'Account';
            document.getElementById('modalContent').innerHTML = `
                <div class="space-y-4">
                    <div class="bg-slate-900 rounded-xl p-4 border border-slate-700">
                        <div class="text-white font-mono text-sm mb-3">${account}</div>
                        <button onclick="copyAddress()" class="w-full bg-slate-800 text-white py-2 rounded-lg text-sm font-semibold">üìã Copy</button>
                    </div>
                    <button onclick="disconnectWallet()" class="w-full bg-red-500/10 border border-red-500/30 text-red-400 py-3 rounded-lg font-bold">Disconnect</button>
                </div>
            `;
        }

        function disconnectWallet() {
            account = '';
            localStorage.removeItem('walletType');
            document.getElementById('connectBtn').innerHTML = 'Connect Wallet';
            document.getElementById('connectBtn').onclick = showWalletOptions;
            closeModal();
            showNotification('Disconnected', 'info');
        }

        function copyAddress() {
            navigator.clipboard.writeText(account);
            showNotification('Copied!', 'success');
        }

        async function autoReconnect() {
            const walletType = localStorage.getItem('walletType');
            if (walletType === 'metamask' && typeof window.ethereum !== 'undefined') {
                try {
                    const accounts = await window.ethereum.request({ method: 'eth_accounts' });
                    if (accounts.length > 0) {
                        account = accounts[0];
                        web3 = new Web3(window.ethereum);
                        updateUI();
                        await loadBalances();
                    }
                } catch (error) {}
            }
        }

        async function loadBalances() {
            if (!account || !web3) return;
            try {
                const bnbBalance = await web3.eth.getBalance(account);
                const bnbFormatted = parseFloat(web3.utils.fromWei(bnbBalance, 'ether')).toFixed(4);
                const jercatContract = new web3.eth.Contract(ERC20_ABI, JERCAT_ADDRESS);
                const jercatBalance = await jercatContract.methods.balanceOf(account).call();
                const jercatFormatted = parseFloat(web3.utils.fromWei(jercatBalance, 'ether')).toFixed(2);
                document.getElementById('fromBalance').textContent = bnbFormatted;
                document.getElementById('toBalance').textContent = jercatFormatted;
                document.getElementById('headerBalance').textContent = jercatFormatted;
            } catch (error) {
                console.error(error);
            }
        }

        function validateAndCalculate(input) {
            let value = input.value.replace(/[^0-9.]/g, '');
            input.value = value;
            if (value && parseFloat(value) > 0) calculateSwap(); else clearSwap();
        }

        function clearSwap() {
            document.getElementById('toAmount').value = '';
            document.getElementById('tradeDetails').classList.add('hidden');
            document.getElementById('swapBtn').textContent = account ? 'Enter Amount' : 'Connect Wallet';
        }

        async function calculateSwap() {
            const fromAmount = parseFloat(document.getElementById('fromAmount').value);
            if (!fromAmount || !account) return;
            try {
                const router = new web3.eth.Contract(ROUTER_ABI, PANCAKESWAP_ROUTER);
                const path = [fromToken.address, toToken.address];
                const amountIn = web3.utils.toWei(fromAmount.toString(), 'ether');
                const amounts = await router.methods.getAmountsOut(amountIn, path).call();
                const amountOut = parseFloat(web3.utils.fromWei(amounts[1], 'ether'));
                document.getElementById('toAmount').value = amountOut.toFixed(6);
                document.getElementById('exchangeRate').textContent = `1 ${fromToken.symbol} = ${(amountOut/fromAmount).toFixed(6)} ${toToken.symbol}`;
                const rewardAmount = (fromAmount * bnbPrice * 0.001 / jercatPrice);
                document.getElementById('rewardAmount').textContent = rewardAmount.toFixed(4) + ' JERCAT';
                document.getElementById('tradeDetails').classList.remove('hidden');
                document.getElementById('swapBtn').textContent = 'Swap';
            } catch (error) {
                console.error(error);
            }
        }

        async function handleSwap() {
            if (!account) { showWalletOptions(); return; }
            showNotification('Swap functionality ready - complete implementation needed', 'info');
        }

        function switchTokens() {
            [fromToken, toToken] = [toToken, fromToken];
            document.getElementById('fromTokenLogo').textContent = fromToken.logo;
            document.getElementById('fromTokenSymbol').textContent = fromToken.symbol;
            document.getElementById('toTokenLogo').textContent = toToken.logo;
            document.getElementById('toTokenSymbol').textContent = toToken.symbol;
            if (account) loadBalances();
        }

        function setMaxAmount() {
            const balance = document.getElementById('fromBalance').textContent;
            const maxAmount = parseFloat(balance);
            if (maxAmount > 0) {
                document.getElementById('fromAmount').value = (maxAmount - 0.01).toFixed(6);
                calculateSwap();
            }
        }

        function switchTab(tab) {
            document.querySelectorAll('.content-section').forEach(s => s.classList.add('hidden'));
            document.getElementById(`content-${tab}`).classList.remove('hidden');
            ['swap','wallet','portfolio','staking','rewards'].forEach(t => {
                const btn = document.getElementById(`tab-${t}`);
                if (t === tab) btn.classList.add('tab-active'); else btn.classList.remove('tab-active');
            });
        }

        async function updatePrices() {
            try {
                const response = await fetch(`https://api.dexscreener.com/latest/dex/tokens/${JERCAT_ADDRESS}`);
                const data = await response.json();
                if (data.pairs && data.pairs.length > 0) {
                    const pair = data.pairs[0];
                    jercatPrice = parseFloat(pair.priceUsd) || 0.00001;
                    document.getElementById('headerPrice').textContent = jercatPrice.toFixed(6);
                }
            } catch (error) {
                jercatPrice = 0.00001;
            }
        }

        function initCharts() {
            // Simplified - charts can be fully implemented
        }

        function showNotification(message, type = 'info') {
            const colors = { success: 'bg-emerald-500', error: 'bg-red-500', info: 'bg-blue-500', warning: 'bg-amber-500' };
            const notif = document.createElement('div');
            notif.className = `${colors[type]} text-white px-6 py-4 rounded-lg shadow-lg max-w-sm animate-slide-in`;
            notif.textContent = message;
            document.getElementById('notifications').appendChild(notif);
            setTimeout(() => notif.remove(), 4000);
        }

        window.addEventListener('load', init);
        if (window.ethereum) {
            window.ethereum.on('accountsChanged', accounts => {
                if (accounts.length > 0) { account = accounts[0]; updateUI(); loadBalances(); } else disconnectWallet();
            });
        }
    </script>
</body>
</html>
